# 自动化发布工具使用说明

## 📋 功能概述

这是一个基于 Puppeteer 的自动化发布工具，支持小红书和抖音平台的自动登录、内容填写、文件上传和发布功能。

## 🚀 快速开始

### 1. 安装前端依赖（如果还没有）

```bash
npm install
# 或
pnpm install
```

### 2. 安装后端依赖

```bash
cd server
npm install
```

### 3. 启动后端服务

```bash
cd server
npm start
```

后端服务将在 `http://localhost:3000` 启动

### 4. 启动前端开发服务器

```bash
npm run dev
```

### 5. 访问自动化发布页面

在浏览器中访问：`http://localhost:5173/auto-publish`（端口可能不同，请查看终端输出）

## 📖 使用步骤

### 第一步：登录

1. 在页面上选择平台（小红书或抖音）
2. 点击"登录"按钮
3. 浏览器会自动打开小红书创作者中心登录页面（`https://creator.xiaohongshu.com/login`）
4. 请在浏览器中完成登录（扫码或账号密码）
5. 登录成功后，Cookie 会自动保存
6. 下次使用时，点击"检查状态"可以验证登录状态

**注意**：小红书使用创作者中心登录页面，登录后会自动跳转到创作者中心，便于后续发布操作。

### 第二步：填写内容

1. 填写标题（必填）
2. 填写内容（必填）
3. 上传图片/视频（可选，最多9个文件）
4. 配置发布设置：
   - 启用随机延迟：降低被平台检测的风险
   - 保存为草稿：不立即发布，只保存

### 第三步：发布

1. 点击"立即发布"或"保存草稿"按钮
2. 等待自动化流程完成
3. 查看操作日志了解执行情况

## 🔧 技术实现

### Cookie 复用机制

- Cookie 保存在 `server/cookies/` 目录
- 文件名格式：`{platform}-cookies.json`
- 登录后自动保存，下次启动时自动加载
- 避免频繁扫码登录

### 反检测措施

1. **隐藏 WebDriver 特征**
   - 移除 `navigator.webdriver` 属性
   - 模拟真实浏览器环境

2. **随机延迟**
   - 操作之间添加 1-3 秒随机延迟
   - 模拟人类操作速度

3. **真实 User-Agent**
   - 使用真实的 Chrome User-Agent

4. **Cookie 复用**
   - 减少登录频率
   - 降低触发反作弊机制的风险

## ⚠️ 重要提示

### 风险警告

1. **账号安全**
   - ⚠️ 自动化操作可能违反平台服务条款
   - ⚠️ 使用前请仔细阅读平台规则
   - ⚠️ 建议使用小号进行测试

2. **使用建议**
   - 不要过于频繁发布（建议每天不超过5-10条）
   - 启用随机延迟功能
   - 确保内容质量，避免违规内容
   - 定期检查登录状态

3. **技术限制**
   - 平台可能更新页面结构，导致脚本失效
   - 需要定期维护和更新选择器
   - Cookie 可能过期，需要重新登录

## 🐛 故障排查

### 问题1：无法连接到后端服务

**解决方案：**
- 确认后端服务已启动（`cd server && npm start`）
- 检查端口 3000 是否被占用
- 点击"测试连接"按钮验证

### 问题2：登录失败

**解决方案：**
- 检查网络连接
- 确认平台页面结构是否变化
- 查看浏览器控制台错误信息
- 尝试删除 `server/cookies/` 目录下的 Cookie 文件重新登录

### 问题3：发布失败

**解决方案：**
- 确认已登录（点击"检查状态"）
- 检查标题和内容是否填写
- 确认文件大小不超过限制（100MB）
- 查看操作日志了解具体错误

### 问题4：Cookie 失效

**解决方案：**
- 删除 `server/cookies/{platform}-cookies.json` 文件
- 重新登录

## 📁 项目结构

```
project-flomo/
├── src/
│   └── pages/
│       └── auto-publish.vue    # 前端页面
├── server/
│   ├── index.js                 # Express 服务器
│   ├── puppeteer-service.js     # Puppeteer 自动化脚本
│   ├── cookies/                 # Cookie 存储目录
│   └── uploads/                 # 临时文件上传目录
└── 使用说明.md                   # 本文件
```

## 🔄 更新日志

### v1.0.0
- ✅ 支持小红书和抖音平台
- ✅ 自动登录和 Cookie 复用
- ✅ 自动填写标题和内容
- ✅ 文件上传功能
- ✅ 反检测机制
- ✅ 随机延迟功能

## 📝 注意事项

1. **首次使用**：需要手动登录一次，之后 Cookie 会自动保存
2. **页面选择器**：如果平台更新页面结构，可能需要更新选择器
3. **文件上传**：大文件上传可能需要较长时间，请耐心等待
4. **浏览器窗口**：登录和发布时会打开浏览器窗口，这是正常的

## 💡 最佳实践

1. **频率控制**：建议每天发布数量控制在合理范围（5-10条）
2. **内容质量**：确保内容原创且符合平台规范
3. **时间间隔**：发布之间建议间隔至少30分钟
4. **定期检查**：定期检查登录状态和 Cookie 有效性
5. **备份 Cookie**：重要账号的 Cookie 建议备份

## 🆘 获取帮助

如果遇到问题：
1. 查看操作日志了解详细错误信息
2. 检查浏览器控制台和服务器日志
3. 确认网络连接和平台服务状态
4. 尝试重新登录或清除 Cookie

---

**免责声明**：本工具仅供学习和研究使用，使用者需自行承担使用风险。请遵守平台服务条款和相关法律法规。

